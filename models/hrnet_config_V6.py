from yacs.config import CfgNode as CN

# configs for HRNet64
HRNET_64 = CN()
HRNET_64.STEM_INPLANES = 64
HRNET_64.FINAL_CONV_KERNEL = 1
HRNET_64.WITH_HEAD = True

HRNET_64.STAGE2 = CN()
HRNET_64.STAGE2.NUM_MODULES = 1
HRNET_64.STAGE2.NUM_BRANCHES = 2
HRNET_64.STAGE2.NUM_BLOCKS = [4, 4]
HRNET_64.STAGE2.NUM_CHANNELS = [64, 128]
HRNET_64.STAGE2.BLOCK = 'BASIC'
HRNET_64.STAGE2.FUSE_METHOD = 'SUM'

HRNET_64.STAGE3 = CN()
HRNET_64.STAGE3.NUM_MODULES = 4
HRNET_64.STAGE3.NUM_BRANCHES = 3
HRNET_64.STAGE3.NUM_BLOCKS = [4, 4, 4]
HRNET_64.STAGE3.NUM_CHANNELS = [64, 128, 256]
HRNET_64.STAGE3.BLOCK = 'BASIC'
HRNET_64.STAGE3.FUSE_METHOD = 'SUM'

HRNET_64.STAGE4 = CN()
HRNET_64.STAGE4.NUM_MODULES = 3
HRNET_64.STAGE4.NUM_BRANCHES = 4
HRNET_64.STAGE4.NUM_BLOCKS = [4, 4, 4, 4]
HRNET_64.STAGE4.NUM_CHANNELS = [64, 128, 256, 512]
HRNET_64.STAGE4.BLOCK = 'BASIC'
HRNET_64.STAGE4.FUSE_METHOD = 'SUM'


# configs for HRNet48
HRNET_48 = CN()
HRNET_48.STEM_INPLANES = 64
HRNET_48.FINAL_CONV_KERNEL = 1
HRNET_48.WITH_HEAD = True

HRNET_48.STAGE1 = CN()
HRNET_48.STAGE1.NUM_BLOCKS = [12]

HRNET_48.STAGE2 = CN()
HRNET_48.STAGE2.NUM_MODULES = 3
HRNET_48.STAGE2.NUM_BRANCHES = 2
HRNET_48.STAGE2.NUM_BLOCKS = [4, 4]
HRNET_48.STAGE2.NUM_CHANNELS = [64, 128]
HRNET_48.STAGE2.BLOCK = 'BASIC'
HRNET_48.STAGE2.FUSE_METHOD = 'SUM'

HRNET_48.STAGE3 = CN()
HRNET_48.STAGE3.NUM_MODULES = 9
HRNET_48.STAGE3.NUM_BRANCHES = 3
HRNET_48.STAGE3.NUM_BLOCKS = [4, 4, 4]
HRNET_48.STAGE3.NUM_CHANNELS = [64, 128, 256]
HRNET_48.STAGE3.BLOCK = 'BASIC'
HRNET_48.STAGE3.FUSE_METHOD = 'SUM'

HRNET_48.STAGE4 = CN()
HRNET_48.STAGE4.NUM_MODULES = 3
HRNET_48.STAGE4.NUM_BRANCHES = 4
HRNET_48.STAGE4.NUM_BLOCKS = [4, 4, 4, 4]
HRNET_48.STAGE4.NUM_CHANNELS = [64, 128, 256, 512]
HRNET_48.STAGE4.BLOCK = 'BASIC'
HRNET_48.STAGE4.FUSE_METHOD = 'SUM'
HRNET_48.DROP_PATH_RATE = 0.5

# configs for HRNet32
HRNET_32 = CN()
HRNET_32.PRETRAINED_LAYERS = ['*']
HRNET_32.STEM_INPLANES = 64
HRNET_32.FINAL_CONV_KERNEL = 1
HRNET_32.WITH_HEAD = True

HRNET_32.STAGE2 = CN()
HRNET_32.STAGE2.NUM_MODULES = 1
HRNET_32.STAGE2.NUM_BRANCHES = 2
HRNET_32.STAGE2.NUM_BLOCKS = [4, 4]
HRNET_32.STAGE2.NUM_CHANNELS = [32, 64]
HRNET_32.STAGE2.BLOCK = 'BASIC'
HRNET_32.STAGE2.FUSE_METHOD = 'SUM'

HRNET_32.STAGE3 = CN()
HRNET_32.STAGE3.NUM_MODULES = 4
HRNET_32.STAGE3.NUM_BRANCHES = 3
HRNET_32.STAGE3.NUM_BLOCKS = [4, 4, 4]
HRNET_32.STAGE3.NUM_CHANNELS = [32, 64, 128]
HRNET_32.STAGE3.BLOCK = 'BASIC'
HRNET_32.STAGE3.FUSE_METHOD = 'SUM'

HRNET_32.STAGE4 = CN()
HRNET_32.STAGE4.NUM_MODULES = 3
HRNET_32.STAGE4.NUM_BRANCHES = 4
HRNET_32.STAGE4.NUM_BLOCKS = [4, 4, 4, 4]
HRNET_32.STAGE4.NUM_CHANNELS = [32, 64, 128, 256]
HRNET_32.STAGE4.BLOCK = 'BASIC'
HRNET_32.STAGE4.FUSE_METHOD = 'SUM'


# configs for HRNet48
HRNET_48_LARGE = CN()
HRNET_48_LARGE.STEM_INPLANES = 64
HRNET_48_LARGE.FINAL_CONV_KERNEL = 1
HRNET_48_LARGE.WITH_HEAD = True

HRNET_48_LARGE.STAGE1 = CN()
HRNET_48_LARGE.STAGE1.NUM_BLOCKS = [12]

HRNET_48_LARGE.STAGE2 = CN()
HRNET_48_LARGE.STAGE2.NUM_MODULES = 3
HRNET_48_LARGE.STAGE2.NUM_BRANCHES = 2
HRNET_48_LARGE.STAGE2.NUM_BLOCKS = [4, 4]
HRNET_48_LARGE.STAGE2.NUM_CHANNELS = [72, 144]
HRNET_48_LARGE.STAGE2.BLOCK = 'BASIC'
HRNET_48_LARGE.STAGE2.FUSE_METHOD = 'SUM'

HRNET_48_LARGE.STAGE3 = CN()
HRNET_48_LARGE.STAGE3.NUM_MODULES = 9
HRNET_48_LARGE.STAGE3.NUM_BRANCHES = 3
HRNET_48_LARGE.STAGE3.NUM_BLOCKS = [4, 4, 4]
HRNET_48_LARGE.STAGE3.NUM_CHANNELS = [72, 144, 288]
HRNET_48_LARGE.STAGE3.BLOCK = 'BASIC'
HRNET_48_LARGE.STAGE3.FUSE_METHOD = 'SUM'

HRNET_48_LARGE.STAGE4 = CN()
HRNET_48_LARGE.STAGE4.NUM_MODULES = 3
HRNET_48_LARGE.STAGE4.NUM_BRANCHES = 4
HRNET_48_LARGE.STAGE4.NUM_BLOCKS = [4, 4, 4, 4]
HRNET_48_LARGE.STAGE4.NUM_CHANNELS = [72, 144, 288, 576]
HRNET_48_LARGE.STAGE4.BLOCK = 'BASIC'
HRNET_48_LARGE.STAGE4.FUSE_METHOD = 'SUM'
HRNET_48_LARGE.DROP_PATH_RATE = 0.5


# configs for HRNet18
HRNET_18 = CN()
HRNET_18.PRETRAINED_LAYERS = ['*']
HRNET_18.STEM_INPLANES = 64
HRNET_18.FINAL_CONV_KERNEL = 1
HRNET_18.WITH_HEAD = True

HRNET_18.STAGE2 = CN()
HRNET_18.STAGE2.NUM_MODULES = 1
HRNET_18.STAGE2.NUM_BRANCHES = 2
HRNET_18.STAGE2.NUM_BLOCKS = [4, 4]
HRNET_18.STAGE2.NUM_CHANNELS = [18, 36]
HRNET_18.STAGE2.BLOCK = 'BASIC'
HRNET_18.STAGE2.FUSE_METHOD = 'SUM'

HRNET_18.STAGE3 = CN()
HRNET_18.STAGE3.NUM_MODULES = 4
HRNET_18.STAGE3.NUM_BRANCHES = 3
HRNET_18.STAGE3.NUM_BLOCKS = [4, 4, 4]
HRNET_18.STAGE3.NUM_CHANNELS = [18, 36, 72]
HRNET_18.STAGE3.BLOCK = 'BASIC'
HRNET_18.STAGE3.FUSE_METHOD = 'SUM'

HRNET_18.STAGE4 = CN()
HRNET_18.STAGE4.NUM_MODULES = 3
HRNET_18.STAGE4.NUM_BRANCHES = 4
HRNET_18.STAGE4.NUM_BLOCKS = [4, 4, 4, 4]
HRNET_18.STAGE4.NUM_CHANNELS = [18, 36, 72, 144]
HRNET_18.STAGE4.BLOCK = 'BASIC'
HRNET_18.STAGE4.FUSE_METHOD = 'SUM'


MODEL_CONFIGS = {
    'hrnet18': HRNET_18,
    'hrnet32': HRNET_32,
    'hrnet48': HRNET_48,
    'hrnet64': HRNET_64,
    'hrnet48_large': HRNET_48_LARGE
}
